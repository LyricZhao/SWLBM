// size changed

const Real wM[20] = {
		(1./18.),(1./18.),(1./18.),(1./18.),(1./18.),(1./18.),
		(1./36.),(1./36.),(1./36.),(1./36.),(1./36.),(1./36.),
		(1./36.),(1./36.),(1./36.),(1./36.),(1./36.),(1./36.),(1./3.),0}; // Add an 0

//                     0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19
const Real e_xM[20] = {0, 0, 1,-1, 0, 0, 1,-1, 1,-1, 0, 0, 0, 0, 1, 1,-1,-1, 0, 0}; // Add an 0
const Real e_yM[20] = {1,-1, 0, 0, 0, 0, 1, 1,-1,-1, 1, 1,-1,-1, 0, 0, 0, 0, 0, 0}; // Add an 0
const Real e_zM[20] = {0, 0, 0, 0, 1,-1, 0, 0, 0, 0, 1,-1, 1,-1, 1,-1, 1,-1, 0, 0}; // Add an 0
// 10 + 10 + 10 + 4 + 4 + 4
// xx: 23 6-9 14-17
// yy: 01 6-13
// zz: 45 10-17
// xy: 6-9 +--+
// xz: 14-17 +--+
// yz: 10-13 +--+
// 												0  1  2  3  4  5  6  7  8  9  10  11  12  13  14  15  16  17  18
// const int dfInv[19] = {1, 0, 3, 2, 5, 4, 9, 8, 7, 6, 13, 12, 11, 10, 17, 16, 15, 14, 18};

// exyz[inv]
/*
	 00:  0 -1  0
   01:  0  1  0
	 02: -1  0  0
	 03:  1  0  0
	 04:  0  0 -1
	 05:  0  0  1
	 06: -1 -1  0
	 07:  1 -1  0
	 08: -1  1  0
	 09:  1  1  0
	 10:  0 -1 -1
	 11:  0 -1  1
	 12:  0  1 -1
	 13:  0  1  1
	 14: -1  0 -1
	 15: -1  0  1
	 16:  1  0 -1
	 17:  1  0  1
	 18:  0  0  0
*/

void computeOneStep(Real *****nodes, char ****walls, int ***flags, int Xst, int Xed, int Yst, int Yed, int nz, int current);
